<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Timetable GA — Engineering Timetable</title>

  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
  <link rel="stylesheet" href="./dist/styles.css">
  <!-- Light theme timetable override -->
  <style>
    /* Light-theme timetable — readable on white backgrounds */
    /* Target the timetable table inside #timetableContainer */
    #timetableContainer .timetable-card,
    #timetableContainer .timetable-card th,
    #timetableContainer .timetable-card td {
      box-sizing: border-box;
      font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }

    /* card */
    #timetableContainer .timetable-card {
      background-color: #ffffff;
      border: 1px solid #e6e8eb;
      border-radius: 8px;
      overflow: hidden;
      color: #0f1724;
      width: 100%;
    }

    /* header cells (days) */
    #timetableContainer .timetable-card thead th {
      background: #f8fafc;
      color: #0f1724;
      font-weight: 700;
      padding: 12px;
      text-align: center;
      border-bottom: 1px solid #e6e8eb;
      font-size: 0.95rem;
    }

    /* normal cells */
    #timetableContainer .timetable-card td {
      background: #ffffff;
      color: #0b1220;
      padding: 12px;
      vertical-align: middle;
      border-left: 1px solid #eef2f6;
      border-bottom: 1px solid #eef2f6;
      min-height: 56px;
    }

    /* zebra row for readability */
    #timetableContainer .timetable-card tbody tr:nth-child(even) td {
      background: #fbfdfe;
    }

    /* course code — primary info */
    #timetableContainer .timetable-card .course-code,
    #timetableContainer .timetable-card .font-semibold {
      display: block;
      font-weight: 700;
      color: #0f1724;
      font-size: 1rem;
      margin-bottom: 6px;
      letter-spacing: -0.2px;
    }

    /* faculty — secondary info */
    #timetableContainer .timetable-card .faculty,
    #timetableContainer .timetable-card .text-xs {
      display: block;
      color: #475569;
      font-weight: 500;
      font-size: 0.88rem;
      line-height: 1.15;
    }

    /* empty cell look */
    #timetableContainer .timetable-card .empty,
    #timetableContainer .timetable-card .text-gray-400 {
      color: #9aa4ad !important;
      font-style: italic;
    }

    /* lab highlight */
    #timetableContainer .timetable-card .lab {
      background: linear-gradient(180deg,#f0fbff,#e6f7ff);
      border-left: 3px solid #38bdf8;
    }

    /* responsive: stack columns on narrow screens */
    @media (max-width: 820px) {
      #timetableContainer .timetable-card thead { display: none; }
      #timetableContainer .timetable-card tbody tr { display: grid; grid-template-columns: 110px 1fr; gap: 8px; align-items: center; }
      #timetableContainer .timetable-card td { padding: 10px; min-height: 48px; }
      #timetableContainer .timetable-card td:first-child { font-weight: 700; }
    }

    /* small hover/focus contrast */
    #timetableContainer .timetable-card td:focus,
    #timetableContainer .timetable-card td:hover {
      outline: 2px solid rgba(15,23,36,0.04);
      background: rgba(15,23,36,0.01);
    }
  </style>

</head>

<body class="p-6 bg-gray-100 text-gray-900">
  <div class="max-w-4xl mx-auto bg-white rounded-lg shadow-md p-6">
    <div class="flex justify-between items-center mb-2">
      <h1 class="text-2xl font-bold">Timetable GA — Engineering Timetable</h1>
    </div>
    <p id="subheading" class="text-sm text-gray-500 mb-4">Upload 4 CSV files (courses, faculty, slots, rooms) or enter data manually. Click Generate.</p>

    <div id="statusBlock" class="mb-4 text-sm text-gray-700 flex items-center space-x-3">
      <div id="spinner" class="hidden" aria-hidden="true">
        <svg class="animate-spin h-5 w-5 text-indigo-600" xmlns="http://www.w3.org/2000/svg" fill="none"
          viewBox="0 0 24 24">
          <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
          <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"></path>
        </svg>
      </div>
      <div id="status" class="flex-1"></div>
    </div>

    <div class="mb-4 flex items-center space-x-4">
      <label class="inline-flex items-center">
        <input id="modeUpload" type="radio" name="inputMode" class="form-radio h-4 w-4 text-indigo-600" checked>
        <span class="ml-2 text-sm">Upload CSVs</span>
      </label>
      <label class="inline-flex items-center">
        <input id="modeManual" type="radio" name="inputMode" class="form-radio h-4 w-4 text-indigo-600">
        <span class="ml-2 text-sm">Enter data manually</span>
      </label>
      <div class="text-xs text-gray-500 ml-4">If you don't have CSV files, choose “Enter data manually”.</div>
    </div>

    <div id="manualArea" class="mb-4 hidden bg-white rounded-lg p-4">
      <div class="mb-3">
        <h3 class="font-medium">Courses</h3>
        <p class="text-xs text-gray-500 mb-1">Enter course details. L-T-P format: Lectures-Tutorials-Practicals (e.g., 3-0-2). Lab duration is 2 hours.</p>
        <table id="coursesTable" class="w-full text-sm border-collapse">
          <thead class="text-xs text-gray-700 uppercase bg-gray-50">
            <tr>
              <th class="p-2 border">Code</th>
              <th class="p-2 border">L-T-P</th>
              <th class="p-2 border">Faculty ID</th>
              <th class="p-2 border">Student Group</th>
              <th class="p-2 border">Student Count</th>
              <th class="p-2 border">Lec Room Type</th>
              <th class="p-2 border">Lab Room Type</th>
              <th class="p-2 border">Action</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
        <button id="addCourse" type="button" class="mt-2 px-2 py-1 bg-indigo-600 hover:bg-indigo-700 text-white text-sm rounded">+ Add course</button>
      </div>

      <div class="mb-3">
        <h3 class="font-medium">Faculty</h3>
        <p class="text-xs text-gray-500 mb-1">Enter faculty details. IDs are used to link courses.</p>
        <table id="facultyTable" class="w-full text-sm border-collapse">
          <thead class="text-xs text-gray-700 uppercase bg-gray-50">
            <tr>
              <th class="p-2 border">ID</th>
              <th class="p-2 border">Name</th>
              <th class="p-2 border">Action</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
        <button id="addFaculty" type="button" class="mt-2 px-2 py-1 bg-indigo-600 hover:bg-indigo-700 text-white text-sm rounded">+ Add faculty</button>
      </div>

      <div class="mb-3">
        <h3 class="font-medium">Rooms</h3>
        <p class="text-xs text-gray-500 mb-1">Define available rooms, their type (e.g., LectureHall, ComputerLab), and capacity.</p>
        <table id="roomsTable" class="w-full text-sm border-collapse">
          <thead class="text-xs text-gray-700 uppercase bg-gray-50">
            <tr>
              <th class="p-2 border">Room ID</th>
              <th class="p-2 border">Room Type</th>
              <th class="p-2 border">Capacity</th>
              <th class="p-2 border">Action</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
        <button id="addRoom" type="button" class="mt-2 px-2 py-1 bg-indigo-600 hover:bg-indigo-700 text-white text-sm rounded">+ Add room</button>
      </div>

      <div>
        <h3 class="font-medium">Slots / Timetable Row</h3>
        <p class="text-xs text-gray-500 mb-1">Add the day's time blocks. Mark each row as <strong>Class</strong>, <em>Break</em>, <em>Lunch</em>, or <em>Holiday</em>. Only rows with type <strong>Class</strong> will be used as assignable slots.</p>
        <table id="slotsTable" class="w-full text-sm border-collapse">
          <thead class="text-xs text-gray-700 uppercase bg-gray-50">
            <tr>
              <th class="p-2 border">Day</th>
              <th class="p-2 border">Start Time</th>
              <th class="p-2 border">End Time</th>
              <th class="p-2 border">Type</th>
              <th class="p-2 border">Action</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>

        <div class="mt-2 flex gap-2">
          <button id="addSlot" type="button" class="px-2 py-1 bg-indigo-600 hover:bg-indigo-700 text-white text-sm rounded">+ Add slot row</button>
          <button id="addCommonDay" type="button" class="ml-2 px-3 py-2 bg-gray-100 rounded-lg">+ Add common weekday slots</button>
        </div>

        <p class="text-xs text-gray-500 mt-2">Tip: use <strong>+ Add common weekday slots</strong> to build a template for a day and copy to other weekdays.</p>
      </div>
    </div>

    <form id="uploadForm" class="space-y-4">
      <div class="flex items-center space-x-4">
        <label for="courses" class="flex-shrink-0 px-2 py-1 text-sm font-medium text-white bg-indigo-600 rounded-lg cursor-pointer hover:bg-indigo-700">Choose Courses CSV</label>
        <input id="courses" type="file" accept=".csv" class="hidden" />
        <span id="courses-filename" class="text-sm text-gray-500 truncate">No file chosen</span>
      </div>

      <div class="flex items-center space-x-4">
        <label for="faculty" class="flex-shrink-0 px-2 py-1 text-sm font-medium text-white bg-indigo-600 rounded-lg cursor-pointer hover:bg-indigo-700">Choose Faculty CSV</label>
        <input id="faculty" type="file" accept=".csv" class="hidden" />
        <span id="faculty-filename" class="text-sm text-gray-500 truncate">No file chosen</span>
      </div>

      <div class="flex items-center space-x-4">
        <label for="slots" class="flex-shrink-0 px-2 py-1 text-sm font-medium text-white bg-indigo-600 rounded-lg cursor-pointer hover:bg-indigo-700">Choose Slots CSV</label>
        <input id="slots" type="file" accept=".csv" class="hidden" />
        <span id="slots-filename" class="text-sm text-gray-500 truncate">No file chosen</span>
      </div>

      <div class="flex items-center space-x-4">
        <label for="rooms" class="flex-shrink-0 px-2 py-1 text-sm font-medium text-white bg-indigo-600 rounded-lg cursor-pointer hover:bg-indigo-700">Choose Rooms CSV</label>
        <input id="rooms" type="file" accept=".csv" class="hidden" />
        <span id="rooms-filename" class="text-sm text-gray-500 truncate">No file chosen</span>
      </div>
    </form>

    <div id="controls" class="mb-4">
      <div class="pt-3">
        <button id="generateBtn" type="button" class="px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg">Generate Timetable</button>
        <button id="sampleBtn" type="button" class="ml-2 px-3 py-2 bg-gray-100 rounded-lg">Fill Sample Data</button>
      </div>
    </div>

    <hr>

    <div id="output" class="space-y-4 hidden">
      <h2 class="text-lg font-medium">Generated Timetable</h2>
      <div id="timetableContainer" class="overflow-auto border rounded-lg p-2 bg-gray-50">
      </div>
      <div>
        <button id="downloadCsv" class="px-3 py-2 bg-amber-500 hover:bg-amber-600 text-white rounded-lg">Download CSV</button>
        <button id="downloadImage" class="ml-2 px-3 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg">Download Image</button>
        <button id="startNew" class="ml-2 px-3 py-2 bg-gray-200 rounded-lg">Start New</button>
      </div>
    </div>
  </div>

  <div id="modalRoot"></div>

  <script src="./config.js"></script>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
  <script src="./src/main.js" defer></script>
</body>

</html>